<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>è‡ºç§‘æ³•å¾‹èˆ‡ç”Ÿæ´»è€ƒå‰æ¸¬é©—ç·´ç¿’</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>âš–ï¸</text></svg>">
    
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: #0f172a; /* Slate 900 */
            color: #e2e8f0; /* Slate 200 */
            touch-action: manipulation;
        }
        .neon-text {
            text-shadow: 0 0 10px rgba(56, 189, 248, 0.5);
        }
        .neon-purple {
            text-shadow: 0 0 10px rgba(168, 85, 247, 0.5);
        }
        .input-glow:focus {
            box-shadow: 0 0 15px rgba(168, 85, 247, 0.5);
            border-color: #a855f7;
        }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #1e293b; }
        ::-webkit-scrollbar-thumb { background: #475569; border-radius: 4px; }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .shake { animation: shake 0.3s ease-in-out; }
        
        .btn-press:active { transform: scale(0.98); }
        
        .fade-in { animation: fadeIn 0.5s ease-out; }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card-hover:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.5), 0 8px 10px -6px rgba(0, 0, 0, 0.5);
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center justify-center p-4">

    <div id="root" class="w-full max-w-2xl"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef, useCallback } = React;

        // ==========================================
        // è³‡æ–™åº«å€åŸŸ (Database)
        // ==========================================

        // --- æœŸä¸­è€ƒé¡Œåº« ---
        const MIDTERM_QUESTIONS = [
            // 1. å¦¨å®³å¸æ³•å…¬æ­£
            { q: "åˆ‘æ³•ç¬¬173æ¢è¦å®šï¼Œè‹¥å°è­‰äººã€é‘‘å®šäººæˆ–é€šè­¯è¡Œè³„ã€ç´„å®šã€äº¤ä»˜ä¸æ­£åˆ©ç›Šï¼Œè™•______å¹´ä»¥ä¸‹å¾’åˆ‘ã€‚", a: "3" },
            { q: "åˆ‘æ³•ç¬¬173æ¢è¦å®šï¼Œå°è­‰äººè¡Œè³„è€…ï¼Œå¾—ä½µç§‘______è¬å…ƒä»¥ä¸‹ç½°é‡‘ã€‚", a: "30" },
        ];

        // --- æœŸæœ«è€ƒé¡Œåº« ---
        const FINAL_QUESTIONS = [
            // æ¶ˆä¿æ³•
            { q: "æ¶ˆä¿æ³•å®šç¾©çš„æ¶ˆè²»è€…ï¼Œæ˜¯æŒ‡ä»¥æ¶ˆè²»ç‚ºç›®çš„è€Œç‚ºäº¤æ˜“ã€ä½¿ç”¨å•†å“æˆ–æ¥å—______è€…ã€‚", a: "æœå‹™" },
            { q: "é›–éç›´æ¥äº¤æ˜“ç•¶äº‹äººï¼Œä½†å› æ¶ˆè²»è¡Œç‚ºè€Œå—åˆ°æ¬Šç›Šå½±éŸ¿ä¹‹é—œä¿‚äººï¼Œç¨±ç‚º______ã€‚", a: "ç¬¬ä¸‰äºº" },
            { q: "ä¼æ¥­ç¶“ç‡Ÿè€…æ˜¯æŒ‡ä»¥ç”Ÿç”¢ã€è£½é€ ã€é€²å£ã€ç¶“éŠ·æˆ–æä¾›å•†å“æˆ–æœå‹™ç‚º______ä¹‹è‡ªç„¶äººæˆ–æ³•äººã€‚", a: "ç‡Ÿæ¥­" },
            { q: "æ¶ˆè²»é—œä¿‚ä¸­ï¼Œå°å¼±å‹¢åœ°ä½è€…æä¾›ç‰¹æ®Šä¿è­·ï¼Œä¾‹å¦‚é€é______è²¬ä»»å€’ç½®ä¾†å¹³è¡¡è³‡è¨Šä¸å°ç¨±ã€‚", a: "èˆ‰è­‰" },
            
            // æ¶ˆä¿æ³•ç¬¬7æ¢
            { q: "ä¾æ¶ˆä¿æ³•ç¬¬7æ¢ï¼Œä¼æ¥­ç¶“ç‡Ÿè€…æ‡‰ç¢ºä¿å•†å“æˆ–æœå‹™ç¬¦åˆç•¶æ™‚______æˆ–å°ˆæ¥­æ°´æº–å¯åˆç†æœŸå¾…ä¹‹å®‰å…¨æ€§ã€‚", a: "ç§‘æŠ€" },
            { q: "å•†å“æˆ–æœå‹™æœ‰å±å®³å¯èƒ½æ™‚ï¼Œæ‡‰æ–¼æ˜é¡¯è™•ç‚º______æ¨™ç¤ºåŠç·Šæ€¥è™•ç†å±éšªä¹‹æ–¹æ³•ã€‚", a: "è­¦å‘Š" },
            { q: "ä¼æ¥­ç¶“ç‡Ÿè€…é•åæ¶ˆä¿æ³•ç¬¬7æ¢è¦å®šï¼Œè‡´ç”Ÿæå®³æ–¼æ¶ˆè²»è€…æˆ–ç¬¬ä¸‰äººæ™‚ï¼Œæ‡‰è² ______è³ å„Ÿè²¬ä»»ã€‚", a: "é€£å¸¶" },
            { q: "è‹¥ä¼æ¥­ç¶“ç‡Ÿè€…èƒ½è­‰æ˜å…¶ç„¡éå¤±è€…ï¼Œæ³•é™¢å¾—______å…¶è³ å„Ÿè²¬ä»»ã€‚", a: "æ¸›è¼•" },
            { q: "æ¶ˆä¿æ³•ç¬¬7æ¢ç¬¬3é …æ˜ç¢ºå°‡______ç´å…¥ä¿è­·ç¯„åœï¼Œè¶…è¶Šäº†ç›´æ¥æ¶ˆè²»è€…ã€‚", a: "ç¬¬ä¸‰äºº" },
            { q: "ç•¶å±éšªå±¬æ–¼æ—¥å¸¸ç”Ÿæ´»å¯é è¦‹ç¯„åœå…§ï¼Œä¸”æ¶ˆè²»è€…æœ‰èƒ½åŠ›è‡ªè¡Œåˆ¤æ–·æ™‚ï¼Œæ¶ˆè²»è€…é ˆ______è² è²¬ã€‚", a: "è‡ªè¡Œ" },
            { q: "æ—…å®¿æ¥­é­ä»–äººè£è¨­å¾®å‹éŒ„å½±è¨­å‚™ï¼Œæ¶‰åŠç”¢å“æœ¬è³ªå®‰å…¨ï¼Œ______é ˆè² æ“”è²¬ä»»ã€‚", a: "æ¥­è€…" },

            // æœå‹™å®‰å…¨èˆ‡åˆ¤æ–·æ¨™æº–
            { q: "åˆ¤æ–·æœå‹™å®‰å…¨æ¬ ç¼ºèˆ‡å¦ï¼Œå…¶ä¸­ä¸€å€‹æ¨™æº–æ˜¯ä¾æ“š______è§€é»åˆ¤æ–·ï¼Œè€Œéä»¥å°ˆæ¥­è§’åº¦è©•ä¼°ã€‚", a: "ä¸€èˆ¬äºº" },

            // ç§æ³•ä¸‰å¤§åŸå‰‡
            { q: "è¿‘ä»£ç§æ³•çš„ä¸‰å¤§åŸå‰‡åŒ…å«ï¼šæ‰€æœ‰æ¬Šçµ•å°åŸå‰‡ã€______è‡ªç”±åŸå‰‡ã€éå¤±è²¬ä»»åŸå‰‡ã€‚", a: "å¥‘ç´„" },
            { q: "éå¤±è²¬ä»»åŸå‰‡å¼·èª¿è¡Œç‚ºäººå¿…é ˆå­˜åœ¨______è¡Œç‚ºï¼Œæ‰éœ€æ‰¿æ“”è³ å„Ÿè²¬ä»»ã€‚", a: "éå¤±" },
            { q: "å¥‘ç´„è‡ªç”±åŸå‰‡åœ¨ç¾ä»£å—åˆ°é™åˆ¶ï¼Œä¾‹å¦‚å¥‘ç´„å…§å®¹ä¸å¾—é•èƒŒå…¬å…±ç§©åºèˆ‡______ã€‚", a: "å–„è‰¯é¢¨ä¿—" },
            { q: "ç”±ä¼æ¥­é å…ˆæ“¬å®šã€å…§å®¹å›ºå®šä¸”å¤§é‡ä½¿ç”¨çš„å¥‘ç´„ï¼Œç¨±ç‚º______å¥‘ç´„ã€‚", a: "å®šå‹åŒ–" },

            // å®šå‹åŒ–å¥‘ç´„
            { q: "å®šå‹åŒ–å¥‘ç´„ä¸­ä¹‹æ¢æ¬¾é•å______åŸå‰‡ï¼Œå°æ¶ˆè²»è€…é¡¯å¤±å…¬å¹³è€…ï¼Œç„¡æ•ˆã€‚", a: "èª ä¿¡" },
            { q: "å®šå‹åŒ–å¥‘ç´„æ¢æ¬¾è‹¥é•å______äº’æƒ åŸå‰‡ï¼Œæ¨å®šå…¶é¡¯å¤±å…¬å¹³ã€‚", a: "å¹³ç­‰" },
            { q: "ä¸­å¤®ä¸»ç®¡æ©Ÿé—œç‚ºé é˜²æ¶ˆè²»ç³¾ç´›ï¼Œå¾—æ“¬è¨‚å®šå‹åŒ–å¥‘ç´„æ‡‰è¨˜è¼‰æˆ–______è¨˜è¼‰äº‹é …ã€‚", a: "ä¸å¾—" },
            { q: "é•åå…¬å‘Šä¹‹æ‡‰è¨˜è¼‰æˆ–ä¸å¾—è¨˜è¼‰äº‹é …ï¼Œè©²å®šå‹åŒ–å¥‘ç´„æ¢æ¬¾______ã€‚", a: "ç„¡æ•ˆ" },

            // å¥‘ç´„æˆç«‹
            { q: "ä¾æ°‘æ³•ç¬¬153æ¢ï¼Œç•¶äº‹äººäº’ç›¸è¡¨ç¤ºæ„æ€______è€…ï¼Œå¥‘ç´„å³ç‚ºæˆç«‹ã€‚", a: "ä¸€è‡´" },
            { q: "è²·è³£å¥‘ç´„ä¸­ï¼Œç‰©ä¹‹å‡ºè³£äººè² äº¤ä»˜å…¶ç‰©æ–¼è²·å—äººï¼Œä¸¦ä½¿å…¶å–å¾—è©²ç‰©______ä¹‹ç¾©å‹™ã€‚", a: "æ‰€æœ‰æ¬Š" },

            // æ³•å¾‹ä¿ç•™èˆ‡æ¯”ä¾‹åŸå‰‡
            { q: "______ä¿ç•™åŸå‰‡å¼·èª¿æ”¿åºœå°äººæ°‘è‡ªç”±æ¬Šåˆ©çš„é™åˆ¶å¿…é ˆå…·æœ‰æ³•å¾‹ä¾æ“šã€‚", a: "æ³•å¾‹" },
            { q: "æ¯”ä¾‹åŸå‰‡ä¸­çš„______æ€§åŸå‰‡ï¼ŒæŒ‡æ‰‹æ®µå¿…é ˆæ˜¯åˆé©çš„ï¼Œå¯æœ‰æ•ˆé”æˆé æœŸç›®æ¨™ã€‚", a: "é©ç•¶" },
            { q: "æ¯”ä¾‹åŸå‰‡ä¸­çš„______æ€§åŸå‰‡ï¼Œåˆç¨±ã€Œä¾µå®³æœ€å°åŸå‰‡ã€ï¼ŒæŒ‡æ‡‰æ¡å–å°äººæ°‘ä¾µå®³æœ€å°çš„æ‰‹æ®µã€‚", a: "å¿…è¦" },
            { q: "ç‹¹ç¾©æ¯”ä¾‹åŸå‰‡è¦æ±‚åœ‹å®¶æ¬ŠåŠ›æ‰€é€ æˆçš„ä¾µå®³ï¼Œèˆ‡æ¬²é”æˆä¹‹ç›®çš„é–“æ‡‰æœ‰ç›¸ç•¶çš„______ã€‚", a: "å¹³è¡¡" },
            { q: "å®šå‹åŒ–å¥‘ç´„è‹¥è§£é‡‹æœ‰æ¨¡ç³Šï¼Œæ‡‰ç‚ºæœ‰åˆ©æ–¼______ä¹‹è§£é‡‹ã€‚", a: "æ¶ˆè²»è€…" },
            
            // ç§Ÿè³ƒä½å®…
            { q: "æˆ¿å±‹ä¿®ç¹•ç¾©å‹™åŸå‰‡ä¸Šç”±______è² è²¬ï¼Œé™¤éå¦æœ‰ç´„å®šæˆ–å¯æ­¸è²¬æ–¼æ‰¿ç§Ÿäººã€‚", a: "å‡ºç§Ÿäºº" },
            { q: "æ‰¿ç§Ÿäººæ‡‰ä»¥______ç®¡ç†äººä¹‹æ³¨æ„ï¼Œä¿ç®¡ã€ä½¿ç”¨ç§Ÿè³ƒä½å®…ã€‚", a: "å–„è‰¯" },
            { q: "ç§Ÿè³ƒå¥‘ç´„æå‰çµ‚æ­¢ä¹‹é•ç´„é‡‘ï¼Œæœ€é«˜ä¸å¾—è¶…é______å€‹æœˆç§Ÿé‡‘ã€‚", a: "1" },
            { q: "ç§Ÿç´„ä¸­ä¸å¾—ç´„å®šæ‰¿ç§Ÿäººä¸å¾—é·å…¥______ã€‚", a: "æˆ¶ç±" },
            { q: "ç§Ÿç´„ä¸­ä¸å¾—ç´„å®šæ‰¿ç§Ÿäººç¦æ­¢ç”³è«‹æˆ¿å±‹ç§Ÿé‡‘______ã€‚", a: "è£œè²¼" },
            { q: "æˆ¿æ±éœ€èˆ‰è­‰è­‰æ˜æˆ¿å®¢æœ‰______ç ´å£æƒ…äº‹æ‰èƒ½æ‰£æŠ¼é‡‘ï¼Œè‡ªç„¶è€—æä¸è¡Œã€‚", a: "äººç‚º" },

            // é€šè¨Šäº¤æ˜“
            { q: "é€šè¨Šäº¤æ˜“æ˜¯æŒ‡é€éå»£æ’­ã€é›»è¦–ã€ç¶²è·¯ç­‰æ–¹å¼éŠ·å”®ï¼Œæ¶ˆè²»è€…ç„¡æ³•ç›´æ¥çœ‹åˆ°______ã€‚", a: "å¯¦é«”" },
            { q: "é€šè¨Šäº¤æ˜“æ¶ˆè²»è€…å¾—æ–¼æ”¶å—å•†å“å¾Œ______æ—¥å…§ï¼Œç„¡æ¢ä»¶è§£é™¤å¥‘ç´„ã€‚", a: "7" },
            { q: "é€šè¨Šäº¤æ˜“è§£ç´„ç„¡é ˆèªªæ˜ç†ç”±åŠè² æ“”ä»»ä½•______ã€‚", a: "è²»ç”¨" },
            { q: "é€šè¨Šäº¤æ˜“æœ‰______ä¾‹å¤–æƒ…äº‹è€…ï¼Œä¸é©ç”¨7æ—¥è§£é™¤æ¬Šã€‚", a: "åˆç†" },
            { q: "è‹¥ä¼æ¥­æœªæä¾›è§£é™¤å¥‘ç´„ç›¸é—œè³‡è¨Šï¼Œ7æ—¥çŒ¶è±«æœŸè‡ªæä¾›ä¹‹______æ—¥èµ·ç®—ã€‚", a: "æ¬¡" },
            { q: "ä½†è‡ªæ”¶å—å•†å“èµ·ç®—å·²é€¾______å€‹æœˆè€…ï¼Œè§£é™¤æ¬Šæ¶ˆæ»…ã€‚", a: "4" },

            // åˆç†ä¾‹å¤–æƒ…äº‹
            { q: "æ˜“æ–¼è…æ•—ã€ä¿å­˜æœŸé™è¼ƒçŸ­æˆ–è§£ç´„æ™‚å³å°‡é€¾æœŸä¹‹å•†å“ï¼Œå±¬æ–¼é€šè¨Šäº¤æ˜“çš„______ä¾‹å¤–æƒ…äº‹ã€‚", a: "åˆç†" },
            { q: "ä¾æ¶ˆè²»è€…è¦æ±‚æ‰€ç‚ºä¹‹______åŒ–çµ¦ä»˜ï¼Œæ’é™¤7æ—¥è§£é™¤æ¬Šä¹‹é©ç”¨ã€‚", a: "å®¢è£½" },
            { q: "å·²æ‹†å°ä¹‹______è¡›ç”Ÿç”¨å“ï¼Œæ’é™¤7æ—¥è§£é™¤æ¬Šä¹‹é©ç”¨ã€‚", a: "å€‹äºº" },
            { q: "ç¶“æ¶ˆè²»è€…æ‹†å°ä¹‹å½±éŸ³å•†å“æˆ–______è»Ÿé«”ï¼Œæ’é™¤7æ—¥è§£é™¤æ¬Šã€‚", a: "é›»è…¦" },

            // ç‰¹ç¨®äº¤æ˜“æ³•å¾‹æ•ˆæœ
            { q: "é€šè¨Šäº¤æ˜“è§£ç´„å¾Œï¼Œä¼æ¥­ç¶“ç‡Ÿè€…æ‡‰æ–¼æ”¶åˆ°é€šçŸ¥æ¬¡æ—¥èµ·______æ—¥å…§å–å›å•†å“ã€‚", a: "15" },
            { q: "å¥‘ç´„è§£é™¤å¾Œï¼Œé—œæ–¼å›å¾©åŸç‹€ä¹‹ç´„å®šï¼Œè‹¥è¼ƒæ°‘æ³•è¦å®šä¸åˆ©æ–¼æ¶ˆè²»è€…è€…ï¼Œ______ã€‚", a: "ç„¡æ•ˆ" },

            // ç¦®åˆ¸
            { q: "ç¦®åˆ¸å®šå‹åŒ–å¥‘ç´„ä¸å¾—è¨˜è¼‰______æœŸé™ã€‚", a: "ä½¿ç”¨" },
            { q: "ç¦®åˆ¸ä¸å¾—è¨˜è¼‰æœªä½¿ç”¨å®Œä¹‹é¤˜é¡______æ¶ˆè²»ã€‚", a: "ä¸å¾—" },

            // è¨ªå•äº¤æ˜“
            { q: "è¨ªå•äº¤æ˜“çš„è¦ä»¶ä¹‹ä¸€æ˜¯æ¥­è€…______é‚€ç´„ï¼Œä¸»å‹•å‰å¾€æ¶ˆè²»è€…è™•æ‰€ã€‚", a: "æœªç¶“" },
            { q: "è¡—é ­æ´¾ç™¼å‚³å–®æˆ–è‡¨æ™‚æ”¤ä½æ¨éŠ·ï¼Œå±¬æ–¼______äº¤æ˜“ã€‚", a: "è¨ªå•" },
            { q: "åˆ¤æ–·æ˜¯å¦ç‚ºè¨ªå•äº¤æ˜“ï¼Œæ‡‰æ–Ÿé…Œæ¶ˆè²»è€…æœ‰ç„¡åŒé¡å•†å“ä¹‹______æ©Ÿæœƒã€‚", a: "æ¯”è¼ƒ" },

            // åœ‹å®¶è³ å„Ÿ
            { q: "å…¬å‹™å“¡åŸ·è¡Œè·å‹™è¡Œä½¿å…¬æ¬ŠåŠ›ï¼Œå› æ•…æ„æˆ–______ä¸æ³•ä¾µå®³äººæ°‘æ¬Šåˆ©ï¼Œåœ‹å®¶æ‡‰è² è³ å„Ÿè²¬ä»»ã€‚", a: "éå¤±" },
            { q: "å…¬å‹™å“¡______æ–¼åŸ·è¡Œè·å‹™ï¼Œè‡´äººæ°‘è‡ªç”±æˆ–æ¬Šåˆ©å—æï¼Œåœ‹å®¶äº¦æ‡‰è³ å„Ÿã€‚", a: "æ€ " },
            { q: "å…¬å…±è¨­æ–½å› è¨­ç½®æˆ–______æœ‰æ¬ ç¼ºï¼Œè‡´äººæ°‘å—æï¼Œåœ‹å®¶æ‡‰è² è³ å„Ÿè²¬ä»»ã€‚", a: "ç®¡ç†" },
            { q: "å—å§”è¨—è¡Œä½¿å…¬æ¬ŠåŠ›çš„å€‹äººæˆ–åœ˜é«”ï¼Œæ–¼åŸ·è¡Œè·å‹™æ™‚è¦–åŒ______ã€‚", a: "å…¬å‹™å“¡" },
            { q: "æ–¼é–‹æ”¾ä¹‹å±±åŸŸã€æ°´åŸŸï¼Œç¶“ç®¡ç†æ©Ÿé—œå·²ç‚ºé©ç•¶ä¹‹______ï¼Œäººæ°‘ä»å†’éšªï¼Œåœ‹å®¶ä¸è² è³ å„Ÿè²¬ä»»ã€‚", a: "è­¦å‘Š" },

            // å‹å‹•åŸºæº–æ³• - çµ‚æ­¢å¥‘ç´„
            { q: "é›‡ä¸»æ­‡æ¥­æˆ–è½‰è®“æ™‚ï¼Œå¾—______é å‘Šçµ‚æ­¢å‹å‹•å¥‘ç´„ã€‚", a: "ä¸ç¶“" },
            { q: "å‹å·¥å°æ–¼é›‡ä¸»å¯¦æ–½______æˆ–æœ‰é‡å¤§ä¾®è¾±ä¹‹è¡Œç‚ºè€…ï¼Œé›‡ä¸»å¾—ä¸ç¶“é å‘Šçµ‚æ­¢å¥‘ç´„ã€‚", a: "æš´è¡Œ" },
            { q: "å‹å·¥ç„¡æ­£ç•¶ç†ç”±ç¹¼çºŒæ› å·¥______æ—¥ï¼Œé›‡ä¸»å¾—ä¸ç¶“é å‘Šçµ‚æ­¢å¥‘ç´„ã€‚", a: "3" },
            { q: "å‹å·¥ä¸€å€‹æœˆå…§æ› å·¥é”______æ—¥è€…ï¼Œé›‡ä¸»å¾—ä¸ç¶“é å‘Šçµ‚æ­¢å¥‘ç´„ã€‚", a: "6" },
            { q: "å‹å·¥é•åå‹å‹•å¥‘ç´„æƒ…ç¯€é‡å¤§è€…ï¼Œé›‡ä¸»å¾—______é å‘Šçµ‚æ­¢å¥‘ç´„ã€‚", a: "ä¸ç¶“" },
            { q: "å‹å·¥å—æœ‰æœŸå¾’åˆ‘å®£å‘Šç¢ºå®šä¸”æœªç²______æˆ–æ˜“ç§‘ç½°é‡‘ï¼Œé›‡ä¸»å¾—ä¸ç¶“é å‘Šè§£é›‡ã€‚", a: "ç·©åˆ‘" },

            // å‹å‹•åŸºæº–æ³• - èª¿å‹•
            { q: "é›‡ä¸»èª¿å‹•å‹å·¥å·¥ä½œï¼Œä¸å¾—é•åå‹å‹•å¥‘ç´„ï¼Œä¸”æ‡‰ç¬¦åˆèª¿å‹•______åŸå‰‡ã€‚", a: "äº”" },
            { q: "èª¿å‹•å·¥ä½œåœ°é»éé ï¼Œé›‡ä¸»æ‡‰äºˆä»¥å¿…è¦ä¹‹______ã€‚", a: "å”åŠ©" },

            // è©¦ç”¨æœŸèˆ‡å¹´é™
            { q: "å‹å·¥æ–¼è©¦ç”¨æœŸé–“ä¹‹ç›¸é—œå‹å‹•æ¬Šç›Šï¼Œèˆ‡ä¸€èˆ¬å—åƒ±å‹å·¥______ã€‚", a: "ç„¡ç•°" },
            { q: "å‹å·¥è©¦ç”¨æœŸæ»¿ç¶“è€ƒæ ¸ä¸é©ä»»ï¼Œé›‡ä¸»æ‡‰çµ¦ä»˜______è²»ã€‚", a: "è³‡é£" },
            { q: "é›‡ä¸»è‹¥æœªæä¾›å°ˆæ¥­æŠ€è¡“åŸ¹è¨“åŠè²»ç”¨ï¼Œä¸å¾—èˆ‡å‹å·¥ç´„å®š______æœå‹™å¹´é™ã€‚", a: "æœ€ä½" },
            { q: "è‹¥å‹å‹•å¥‘ç´„å› ä¸å¯æ­¸è²¬æ–¼å‹å·¥ä¹‹äº‹ç”±çµ‚æ­¢ï¼Œå‹å·¥ä¸è² è¿”é‚„______è²»ç”¨ä¹‹è²¬ä»»ã€‚", a: "è¨“ç·´" },

            // ç«¶æ¥­ç¦æ­¢
            { q: "é›‡ä¸»é ˆæœ‰æ‡‰å—ä¿è­·ä¹‹æ­£ç•¶______åˆ©ç›Šï¼Œå§‹å¾—ç´„å®šé›¢è·å¾Œç«¶æ¥­ç¦æ­¢ã€‚", a: "ç‡Ÿæ¥­" },
            { q: "é›¢è·å¾Œç«¶æ¥­ç¦æ­¢ä¹‹æœŸé–“ï¼Œæœ€é•·ä¸å¾—é€¾______å¹´ã€‚", a: "2" },
            { q: "é›‡ä¸»å°å‹å·¥å› ä¸å¾äº‹ç«¶æ¥­è¡Œç‚ºæ‰€å—æå¤±æ‡‰æœ‰åˆç†______ã€‚", a: "è£œå„Ÿ" },

            // è³‡é£é å‘Šèˆ‡è­‰æ˜
            { q: "å‹å·¥å·¥ä½œ3å€‹æœˆä»¥ä¸Š1å¹´æœªæ»¿è€…ï¼Œé›‡ä¸»æ‡‰æ–¼______æ—¥å‰é å‘Šè³‡é£ã€‚", a: "10" },
            { q: "å‹å·¥å·¥ä½œ1å¹´ä»¥ä¸Š3å¹´æœªæ»¿è€…ï¼Œé›‡ä¸»æ‡‰æ–¼______æ—¥å‰é å‘Šè³‡é£ã€‚", a: "20" },
            { q: "å‹å·¥å·¥ä½œ3å¹´ä»¥ä¸Šè€…ï¼Œé›‡ä¸»æ‡‰æ–¼______æ—¥å‰é å‘Šè³‡é£ã€‚", a: "30" },
            { q: "å‹å‹•å¥‘ç´„çµ‚æ­¢æ™‚ï¼Œå‹å·¥è«‹æ±‚ç™¼çµ¦______è­‰æ˜æ›¸ï¼Œé›‡ä¸»ä¸å¾—æ‹’çµ•ã€‚", a: "æœå‹™" },

            // æ¶ˆè²»è€…ä¸‰ä¸å®ˆå‰‡
            { q: "æ¶ˆè²»è€…ä¸‰ä¸å®ˆå‰‡ï¼šå±éšªçš„å…¬å…±å ´æ‰€ä¸å»ã€æ¨™ç¤ºä¸å…¨çš„å•†å“ä¸è²·ã€å•é¡Œçš„______è—¥å“ä¸åƒã€‚", a: "é£Ÿå“" }
        ];

        // Fisher-Yates Shuffle
        const shuffleArray = (array) => {
            let newArr = [...array];
            for (let i = newArr.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [newArr[i], newArr[j]] = [newArr[j], newArr[i]];
            }
            return newArr;
        };

        const generateQuestions = (dataset) => {
            return dataset.map((q, i) => ({ ...q, id: i + 1 }));
        };

        // ==========================================
        // å…ƒä»¶å€åŸŸ (Components)
        // ==========================================

        function SelectionScreen({ onSelect }) {
            return (
                <div className="w-full max-w-4xl mx-auto p-4 flex flex-col items-center fade-in">
                    <div className="mb-12 text-center">
                        <div className="text-6xl mb-4">âš–ï¸</div>
                        <h1 className="text-4xl md:text-5xl font-bold text-white mb-2 neon-text tracking-wider">
                            è‡ºç§‘æ³•å¾‹èˆ‡ç”Ÿæ´»
                        </h1>
                        <p className="text-slate-400 text-lg md:text-xl font-light tracking-widest">
                            è€ƒå‰ç·´ç¿’
                        </p>
                    </div>

                    <div className="grid grid-cols-1 md:grid-cols-2 gap-8 w-full">
                        <button 
                            onClick={() => onSelect('midterm')}
                            className="group bg-slate-800 hover:bg-slate-700 border-2 border-slate-600 hover:border-blue-500 rounded-3xl p-8 transition-all duration-300 card-hover text-left relative overflow-hidden btn-press"
                        >
                            <div className="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                                <span className="text-9xl">ğŸ“š</span>
                            </div>
                            <h2 className="text-3xl font-bold text-blue-400 mb-4 neon-text group-hover:translate-x-2 transition-transform">
                                æœŸä¸­è€ƒç¯„åœ
                            </h2>
                            <p className="text-slate-400 mb-6 group-hover:text-slate-300">
                                æ¶µè“‹ï¼šå¦¨å®³å¸æ³•ã€æ³•å¾‹åŸå‰‡ã€åˆ‘æ³•ã€é†«ç™‚æ³•ç­‰åŸºç¤æ³•å­¸æ¦‚å¿µã€‚
                            </p>
                            <div className="inline-flex items-center text-blue-400 font-bold group-hover:text-blue-300">
                                é–‹å§‹æ¸¬é©— <span className="ml-2">âœ</span>
                            </div>
                        </button>

                        <button 
                            onClick={() => onSelect('final')}
                            className="group bg-slate-800 hover:bg-slate-700 border-2 border-slate-600 hover:border-purple-500 rounded-3xl p-8 transition-all duration-300 card-hover text-left relative overflow-hidden btn-press"
                        >
                            <div className="absolute top-0 right-0 p-4 opacity-10 group-hover:opacity-20 transition-opacity">
                                <span className="text-9xl">ğŸ“</span>
                            </div>
                            <h2 className="text-3xl font-bold text-purple-400 mb-4 neon-purple group-hover:translate-x-2 transition-transform">
                                æœŸæœ«è€ƒç¯„åœ
                            </h2>
                            <p className="text-slate-400 mb-6 group-hover:text-slate-300">
                                æ¶µè“‹ï¼šæ¶ˆä¿æ³•ã€å‹å‹•åŸºæº–æ³•ã€åœ‹å®¶è³ å„Ÿã€å®šå‹åŒ–å¥‘ç´„ç­‰ç”Ÿæ´»æ‡‰ç”¨ã€‚
                            </p>
                            <div className="inline-flex items-center text-purple-400 font-bold group-hover:text-purple-300">
                                é–‹å§‹æ¸¬é©— <span className="ml-2">âœ</span>
                            </div>
                        </button>
                    </div>

                    <div className="mt-12 text-slate-600 text-sm font-mono">
                        <a href="https://github.yijiun.me" target="_blank" rel="noopener noreferrer" className="hover:text-slate-400 transition-colors">
                            Designed for NTUST â€¢ Made by <span className="underline">Yi Jiun Chin</span>
                        </a>
                    </div>
                </div>
            );
        }

        function QuizApp({ dataset, examTitle, onBackToMenu }) {
            const [questions, setQuestions] = useState([]);
            const [wrongQuestions, setWrongQuestions] = useState([]);
            const [currentIndex, setCurrentIndex] = useState(0);
            const [inputValue, setInputValue] = useState("");
            const [feedback, setFeedback] = useState(null); 
            const [score, setScore] = useState(0);
            const [isFinished, setIsFinished] = useState(false);
            const [shake, setShake] = useState(false);
            const [isLoading, setIsLoading] = useState(true);
            const [isReviewMode, setIsReviewMode] = useState(false);

            // Refs
            const inputRef = useRef(null);
            const nextBtnRef = useRef(null);
            const reviewBtnRef = useRef(null);
            const restartBtnRef = useRef(null);

            // åˆå§‹åŒ–
            const initGame = useCallback(() => {
                const baseQuestions = generateQuestions(dataset);
                const shuffled = shuffleArray(baseQuestions);
                setQuestions(shuffled);
                setWrongQuestions([]);
                setCurrentIndex(0);
                setInputValue("");
                setFeedback(null);
                setScore(0);
                setIsFinished(false);
                setIsLoading(false);
                setIsReviewMode(false);
            }, [dataset]);

            // éŒ¯é¡Œç‰¹è¨“æ¨¡å¼
            const startReview = () => {
                if (wrongQuestions.length === 0) return;
                const shuffledWrong = shuffleArray(wrongQuestions);
                setQuestions(shuffledWrong);
                setWrongQuestions([]); 
                setCurrentIndex(0);
                setInputValue("");
                setFeedback(null);
                setScore(0);
                setIsFinished(false);
                setIsReviewMode(true);
            };

            useEffect(() => {
                initGame();
            }, [initGame]);

            // èšç„¦é‚è¼¯
            useEffect(() => {
                if (isLoading) return;

                if (isFinished) {
                    setTimeout(() => {
                        if (wrongQuestions.length > 0) {
                            reviewBtnRef.current?.focus();
                        } else {
                            restartBtnRef.current?.focus();
                        }
                    }, 100);
                    return;
                }

                if (feedback) {
                    setTimeout(() => nextBtnRef.current?.focus(), 50);
                } else {
                    setTimeout(() => inputRef.current?.focus(), 50);
                }
            }, [feedback, isFinished, isLoading, currentIndex, wrongQuestions.length]);

            const checkAnswer = () => {
                if (!questions[currentIndex]) return;
                
                const userAns = inputValue.trim().toLowerCase();
                const correctAns = questions[currentIndex].a.trim().toLowerCase();
                // å¯¬é¬†æ¯”å° logic
                const isNumeric = /^\d+$/.test(correctAns);
                const isCorrect = isNumeric 
                    ? userAns === correctAns
                    : (userAns === correctAns || (userAns.length >= 1 && (userAns.includes(correctAns) || correctAns.includes(userAns))));

                if (isCorrect) {
                    setFeedback('correct');
                    setScore(s => s + 1);
                } else {
                    setFeedback('incorrect');
                    setShake(true);
                    setWrongQuestions(prev => [...prev, questions[currentIndex]]);
                    setTimeout(() => setShake(false), 300);
                }
            };

            const handleKeyDown = (e) => {
                if (e.key === 'Enter') {
                    if (feedback) {
                        nextQuestion();
                    } else {
                        if (inputValue.trim() === "") return;
                        checkAnswer();
                    }
                }
            };

            const nextQuestion = () => {
                setFeedback(null);
                setInputValue("");
                if (currentIndex < questions.length - 1) {
                    setCurrentIndex(c => c + 1);
                } else {
                    setIsFinished(true);
                }
            };

            if (isLoading) return <div className="text-white text-center mt-20">Loading...</div>;

            // çµæŸç•«é¢
            if (isFinished) {
                const isPerfect = score === questions.length;
                
                return (
                    <div className="bg-slate-800 p-8 rounded-2xl shadow-2xl text-center border border-slate-700 w-full animate-fade-in max-w-lg mx-auto mt-10 fade-in relative">
                        {/* Back Button */}
                        <button 
                            onClick={onBackToMenu}
                            className="absolute top-4 left-4 text-slate-400 hover:text-white transition-colors flex items-center gap-1 text-sm font-bold"
                        >
                            â† å›ä¸»é¸å–®
                        </button>

                        <h2 className="text-4xl font-bold mb-6 text-purple-400 neon-text mt-6">
                            {isReviewMode ? "è¤‡ç¿’çµæŸï¼" : `${examTitle}æ¸¬é©—ç·´ç¿’çµæŸï¼`}
                        </h2>
                        
                        <div className="text-6xl font-black mb-4 text-cyan-400">
                            {score} / {questions.length}
                        </div>
                        
                        <p className="text-slate-400 mb-8 text-lg">
                            {isPerfect ? "å®Œç¾ï¼æ‰€æœ‰çš„é¡Œç›®éƒ½è¢«ä½ æ¶ˆæ»…äº†ï¼ğŸ‰" : 
                             `æŠ“åˆ° ${wrongQuestions.length} é¡Œç­”éŒ¯ï¼Œè¦ä¸è¦ç«‹åˆ»è£œè€ƒï¼Ÿ`}
                        </p>

                        <div className="flex flex-col gap-4">
                            {wrongQuestions.length > 0 && (
                                <button 
                                    ref={reviewBtnRef}
                                    onClick={startReview}
                                    className="bg-orange-600 hover:bg-orange-500 text-white font-bold py-4 px-10 rounded-full text-xl transition-all w-full shadow-lg btn-press flex items-center justify-center gap-2 ring-2 ring-orange-400 animate-pulse"
                                >
                                    <span>ğŸ”¥</span> éŒ¯é¡Œç‰¹è¨“ï¼ˆ{wrongQuestions.length} é¡Œï¼‰
                                </button>
                            )}

                            <button 
                                ref={restartBtnRef}
                                onClick={initGame}
                                className={`${wrongQuestions.length > 0 ? 'bg-slate-700 hover:bg-slate-600' : 'bg-purple-600 hover:bg-purple-500'} text-white font-bold py-4 px-10 rounded-full text-xl transition-all w-full shadow-lg btn-press`}
                            >
                                {wrongQuestions.length > 0 ? "æ”¾æ£„è¤‡ç¿’ï¼Œå…¨éƒ¨é‡ä¾† â†»" : "å…¨éƒ¨é‡æ–°æ¸¬é©— â†»"}
                            </button>

                            <button 
                                onClick={onBackToMenu}
                                className="bg-slate-800 hover:bg-slate-700 border border-slate-600 text-slate-300 font-bold py-3 px-10 rounded-full text-lg transition-all w-full btn-press"
                            >
                                å›åˆ°ä¸»é¸å–®
                            </button>
                        </div>
                    </div>
                );
            }

            const currentQ = questions[currentIndex];
            const progressColor = isReviewMode 
                ? "from-orange-400 to-red-500" 
                : (score > currentIndex * 0.8 ? "from-green-400 to-cyan-500" : "from-blue-400 to-purple-500");

            return (
                <div className="w-full max-w-lg mx-auto flex flex-col h-full justify-center">
                    
                    {/* Top Bar */}
                    <div className="flex justify-between items-center mb-4 px-1">
                        <button onClick={onBackToMenu} className="text-slate-500 hover:text-white transition-colors text-sm font-bold flex items-center">
                            â† é›¢é–‹
                        </button>
                        <span className="text-slate-500 text-sm font-bold tracking-widest uppercase">{examTitle}</span>
                    </div>

                    {/* Progress Bar */}
                    <div className="w-full bg-slate-700 h-2 rounded-full mb-6 overflow-hidden">
                        <div 
                            className={`bg-gradient-to-r ${progressColor} h-2 transition-all duration-300 ease-out`}
                            style={{ width: `${((currentIndex + 1) / questions.length) * 100}%` }}
                        ></div>
                    </div>

                    <div className={`bg-slate-800 p-6 md:p-8 rounded-2xl shadow-2xl border ${isReviewMode ? 'border-orange-500/50' : 'border-slate-700'} relative overflow-hidden flex flex-col gap-4 transition-colors duration-500`}>
                        
                        {/* Header Info */}
                        <div className="flex justify-between items-center text-slate-400 text-sm font-mono">
                            <span className={isReviewMode ? "text-orange-400 font-bold" : ""}>
                                {isReviewMode ? "âš ï¸ REVIEW MODE" : `Q ${currentIndex + 1} / ${questions.length}`}
                            </span>
                            <span>Score: {score}</span>
                        </div>

                        {/* Question Text */}
                        <div className="min-h-[100px] flex items-center justify-center">
                            <h3 className="text-2xl font-bold leading-relaxed text-slate-100 text-center">
                                {currentQ && currentQ.q.split('______').map((part, i, arr) => (
                                    <span key={i}>
                                        {part}
                                        {i < arr.length - 1 && (
                                            <span className={`inline-block border-b-4 px-2 mx-1 min-w-[60px] text-center transition-colors duration-300 ${
                                                feedback === 'correct' ? 'border-green-500 text-green-400' : 
                                                feedback === 'incorrect' ? 'border-red-500 text-red-400' : 'border-purple-500 text-transparent'
                                            }`}>
                                                {feedback ? currentQ.a : "?"}
                                            </span>
                                        )}
                                    </span>
                                ))}
                            </h3>
                        </div>

                        {/* Input Area */}
                        <div className={`relative ${shake ? 'shake' : ''}`}>
                            <input
                                ref={inputRef}
                                type="text"
                                value={inputValue}
                                onChange={(e) => setInputValue(e.target.value)}
                                onKeyDown={handleKeyDown}
                                disabled={!!feedback}
                                placeholder="è¼¸å…¥ç­”æ¡ˆ..."
                                className="w-full bg-slate-900 border-2 border-slate-600 text-white text-xl p-4 rounded-xl focus:outline-none input-glow transition-all placeholder-slate-600 text-center"
                                autoComplete="off"
                            />
                        </div>

                        {/* Feedback Area */}
                        <div className={`h-12 flex items-center justify-center font-bold text-center transition-opacity duration-200 ${feedback ? 'opacity-100' : 'opacity-0'}`}>
                            {feedback === 'correct' && <span className="text-green-400 text-lg">âœ… æ­£ç¢ºï¼</span>}
                            {feedback === 'incorrect' && <span className="text-red-400 text-lg">âŒ ç­”æ¡ˆæ˜¯ï¼š{currentQ.a}</span>}
                        </div>

                        {/* Action Buttons */}
                        <div className="mt-2">
                            {!feedback ? (
                                <button
                                    onClick={() => {
                                        if (inputValue.trim() !== "") checkAnswer();
                                    }}
                                    className="w-full bg-blue-600 hover:bg-blue-500 text-white text-xl font-bold py-4 rounded-xl shadow-lg transition-transform btn-press focus:ring-4 focus:ring-blue-400 outline-none"
                                >
                                    é€å‡ºç­”æ¡ˆ
                                </button>
                            ) : (
                                <button
                                    ref={nextBtnRef}
                                    onClick={nextQuestion}
                                    className="w-full bg-green-600 hover:bg-green-500 text-white text-xl font-bold py-4 rounded-xl shadow-lg transition-transform btn-press focus:ring-4 focus:ring-green-400 outline-none flex items-center justify-center gap-2"
                                >
                                    ä¸‹ä¸€é¡Œ âœ
                                </button>
                            )}
                        </div>

                    </div>
                    
                    {/* Mobile Hint */}
                    <div className="mt-6 text-center text-slate-500 text-xs opacity-50">
                        {isReviewMode ? "å†æ¬¡ç­”éŒ¯å°‡æœƒä¿ç•™åœ¨è¤‡ç¿’æ¸…å–®ä¸­" : "æŒ‰ Enter é€å‡ºç­”æ¡ˆ"}
                    </div>
                </div>
            );
        }

        function App() {
            const [examType, setExamType] = useState(null); // 'midterm' | 'final' | null

            const handleSelectMode = (type) => {
                setExamType(type);
            };

            const handleBackToMenu = () => {
                setExamType(null);
            };

            const getDataset = () => {
                if (examType === 'midterm') return MIDTERM_QUESTIONS;
                if (examType === 'final') return FINAL_QUESTIONS;
                return [];
            };

            const getTitle = () => {
                if (examType === 'midterm') return "æœŸä¸­";
                if (examType === 'final') return "æœŸæœ«";
                return "";
            };

            return (
                <div className="w-full min-h-screen flex items-center justify-center">
                    {!examType ? (
                        <SelectionScreen onSelect={handleSelectMode} />
                    ) : (
                        <QuizApp 
                            dataset={getDataset()} 
                            examTitle={getTitle()} 
                            onBackToMenu={handleBackToMenu}
                        />
                    )}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
